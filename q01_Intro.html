<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.547">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Introduction</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./q02-File-organization.html" rel="next">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./q01_Intro.html">Introduction</a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Contents</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./q01_Intro.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./q02-File-organization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">File organization</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./q02a-gmacs-dat-file.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">gmacs.dat file</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./q02b-model-dat-file.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">model.dat file</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./q02c-model-ctl-file.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">model.ctl file</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./q02d-model-prj-file.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">model.prj file</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./q03-GMACS-flags.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">GMACS flags</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#source-code-repository" id="toc-source-code-repository" class="nav-link active" data-scroll-target="#source-code-repository">Source code repository</a></li>
  <li><a href="#installation-and-compilation" id="toc-installation-and-compilation" class="nav-link" data-scroll-target="#installation-and-compilation">Installation and compilation</a>
  <ul class="collapse">
  <li><a href="#user-manual" id="toc-user-manual" class="nav-link" data-scroll-target="#user-manual">User manual</a></li>
  <li><a href="#code-documentation" id="toc-code-documentation" class="nav-link" data-scroll-target="#code-documentation">Code documentation</a></li>
  </ul></li>
  <li><a href="#testing" id="toc-testing" class="nav-link" data-scroll-target="#testing">Testing</a>
  <ul class="collapse">
  <li><a href="#new-approach-post-jan-2025" id="toc-new-approach-post-jan-2025" class="nav-link" data-scroll-target="#new-approach-post-jan-2025">new approach (post-Jan 2025)</a></li>
  <li><a href="#old-approach-pre-jan-2025" id="toc-old-approach-pre-jan-2025" class="nav-link" data-scroll-target="#old-approach-pre-jan-2025">old approach (pre-Jan 2025)</a></li>
  </ul></li>
  <li><a href="#which-tools-are-available-for-working-with-gmacs" id="toc-which-tools-are-available-for-working-with-gmacs" class="nav-link" data-scroll-target="#which-tools-are-available-for-working-with-gmacs">Which tools are available for working with GMACS?</a></li>
  <li><a href="#the-gmacs-development-team" id="toc-the-gmacs-development-team" class="nav-link" data-scroll-target="#the-gmacs-development-team">The Gmacs development team</a></li>
  <li><a href="#noaa-disclaimer" id="toc-noaa-disclaimer" class="nav-link" data-scroll-target="#noaa-disclaimer">NOAA Disclaimer</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Introduction</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>GMACS, the Generalized Assessment Model for Crustacean Stocks, is a general modeling framework used to develop size-structured integrated stock assessment models for exploited crustacean stocks. GMACS is designed to be flexible, scalable, and useful for both data-limited and data-rich situations. Models developed using GMACS (henceforth, “GMACS models” or just “models”) allow the user to determine the impact of fishing on both the historical and current abundance of an exploited population and to evaluate sustainable rates of removals (i.e., catches).</p>
<p>GMACS models can incorporate multiple data types from a variety of sources (e..g. fishery catch data, survey indices) and determine optimal values for unknown model parameters by statistically fitting the data in the form of an integrated analysis <span class="citation" data-cites="maunder_review_2013 punt_review_2013">(<a href="#ref-maunder_review_2013" role="doc-biblioref">Maunder and Punt 2013</a>; <a href="#ref-punt_review_2013" role="doc-biblioref">Punt, Huang, and Maunder 2013</a>)</span>. This approach allows various kinds of data with different (and sometimes incomplete) collection histories to provide complementary information about fished stocks.</p>
<p>Initially developed to assess red king crab stocks in the eastern Bering Sea for the North Pacific Fishery Management Council, GMACS is designed with similar flexibility to that provided by age-structured stock assessment modeling frameworks like <a href="https://vlab.noaa.gov/web/stock-synthesis">Stock Synthesis</a> and <a href="https://niwa.co.nz/fisheries/tools-resources/casal">CASAL</a>. Similar to these modeling frameworks, GMACS provides options to define a population sub-model that simulates stock biological dynamics (growth, maturity,fecundity, recruitment, molting), an observation sub-model that estimates expected values for different kind of data (e.g.&nbsp;fishery and/or survey abundance indices, fisheries discard data, size composition data, …), and a statistical sub-model that quantifies goodness of fit and provides best-fitting parameters estimates and associated variances. The framework also provides options for determining management-related quantities such as <span class="math inline">\(B_{MSY}\)</span>, <span class="math inline">\(F_{MSY}\)</span>, and the sustainable harvest level under various assumptions, as well as the ability to project the population forward under different exploitation scenarios.</p>
<p>GMACS is an open source program based on the AD Model Builder (<a href="http://www.admb-project.org/">ADMB</a>; <span class="citation" data-cites="fournier_ad_2012">(<a href="#ref-fournier_ad_2012" role="doc-biblioref">Fournier et al. 2012</a>)</span>) C++ libraries for parameter estimation, and thus consists of a mixture of ADMB-specific <code>TPL</code> code as well as supplementary C++ code. The <code>gmacsbase.TPL</code> source code file and a library of C++ routines provide the majority of the functionality for models, but a <code>personal.TPL</code> file can be modified by the user to provide additional capabilities.</p>
<section id="source-code-repository" class="level2">
<h2 class="anchored" data-anchor-id="source-code-repository">Source code repository</h2>
<p>The repository with the GMACS TPL and C++ source code is hosted on GitHub at <a href="https://github.com/GMACS-project/GMACS_tpl-cpp_code.git">GMACS_tpl-cpp_code</a>. The base code was distributed by Andre Punt on Jan.&nbsp;18, 2024 following the January 2024 Crab Modeling Workshop in Anchorage, AK. This repository is a bit “cleaner” than the <a href="https://github.com/GMACS-project/GMACS_Assessment_code">GMACS_Assessment_code</a> repository because it contains <strong>only</strong> the base tpl code (<code>gmacsbase.TPL</code>), a template for the <code>personal.TPL</code> code, the src and include sub-folders with C++ code, a platform-independent CMake file to make the gmacs executable, a sub-folder with tests to ensure code changes don’t break old models, and sub-folders to develop and host a users manual. The intention is to restrict the contents of this repository to these items and not to include individual stock assessments or related markdown code.</p>
</section>
<section id="installation-and-compilation" class="level2">
<h2 class="anchored" data-anchor-id="installation-and-compilation">Installation and compilation</h2>
<p>As previously noted, GMACS uses the <a href="http://www.admb-project.org">ADMB</a> C++ libraries, so these must be installed prior to installing and using GMACS. GMACS also provides a script for platform-independent installation using <a href="https://cmake.org">cmake</a>.</p>
<p>For Windows users, it is recommended to install <a href="https://cran.r-project.org/bin/windows/Rtools/rtools43/rtools.html">RTools</a> to provide compilers to build the ADMB libraries, a <code>cmake</code> executable, and unix-like shell functions for various file manipulation tasks. After installing RTools, the user should add the folder containing <code>g++.exe</code> to the front of their Windows PATH so that the RTools compiler/linker is found before any other version (this could be done on a per-terminal session basis). For RTools version 4.3, this would be <code>RTools</code>_64-mingw32.static.posix, where <code>RTools</code> is the top-level folder to which RTools was installed. In addition, add an environment variable <code>RToolsUsr</code> with the path to the <code>Rtools</code>folder so that the unix-like shell commands are available in the Windows Command Prompt window.</p>
<p>For Mac OSX users, a <code>cmake</code> executable and gui can be installed from <a href="https://cmake.org/download/">https://cmake.org/download/</a>.</p>
<p>Once ADMB has been compiled, create the environment variable ADMB_HOME and set it equal to the path to the <code>admb</code> sub-folder of the <code>build</code> directory (i.e., the folder that contains <code>bin</code>, <code>include</code>, and <code>lib</code>). Also, copy (or rename) the libadm-contrib.xxxx.a file in the <code>lib</code> sub-folder to libadmb-contrib.a.</p>
<p>If you have not already done so, clone a copy of this repository to a folder on your local machine.</p>
<p>To compile the GMACS executable, open a command prompt (Windows) or terminal window (Mac OSX) and change directory to the top-level GMACS directory (i.e., the one that contains the gmacsbase.TPL, personal.TPL, and CMakeLists.txt files). Then run the following commands:</p>
<pre><code>* cmake -S . -B _build -G "Unix Makefiles"
* cmake --build _build</code></pre>
<p>The first command creates the <code>_build</code> subfolder and the Makefile appropriate for the given platform (“Unix Makefiles” appears to be an appropriate value for the -G option when compiling with RTools under either OSX or Windows). The second command builds the project by running the Makefile and (if successful) concatenates the gmacsbase.TPL and personal.TPL files as gmacs.tpl, copies this to <code>_build</code>, calls tpl2cpp on gmacs.tpl to create the associated .cpp and .htp files, and finally compiles the source and header files to create the gmacs executble in the <code>_build</code> folder (<code>gmacs</code> on Mac OSX and <code>gmacs.exe</code> on Windows).</p>
<p>Changes to the tpl or c++ files can be recompiled using “cmake –build _build”, which will only update the compilation process for files changed since the last build (i.e., not recompiling everything). An alternative is to open a command prompt or terminal window and change directory to the “_build” folder, then run “make”.</p>
<p>To “start from scratch”, you can either delete the _build folder and run the two commands above again or run “cmake –build _build –target clean” (which deletes the gmacs executable, gmacs.tpl, gmacs.cpp, gmacs.htp and all the object files under the <code>_build</code> folder, but not the CMake-associated files) followed by “cmake –build _build”.</p>
<section id="user-manual" class="level3">
<h3 class="anchored" data-anchor-id="user-manual">User manual</h3>
<p>This user manual (currently under construction) can be accessed <a href="https://gmacs-project.github.io/GMACS_tpl-cpp_code/">here</a>. It can also be built locally as html on your computer from the source distribution. It is written in Quarto Markdown, so you will need <a href="https://quarto.org">Quarto</a> (which conveniently comes with <a href="https://posit.co/products/open-source/rstudio/">RStudio</a>), installed on your computer to create the manual. Once Quarto is installed on your computer, you can create the manual using either a terminal (Command Prompt on Windows) or RStudio.</p>
<section id="using-a-terminal" class="level4">
<h4 class="anchored" data-anchor-id="using-a-terminal">Using a terminal</h4>
<ol type="1">
<li>Open a terminal/Command Prompt window and change directory to the <code>quarto</code> subfolder of the local repository or source distribution</li>
<li>run “quarto render” from the command prompt.</li>
<li><ol start="2" type="1">
<li>will create the manual website in a <code>docs</code>subfolder of the local repo or source distribution.</li>
</ol></li>
<li>The manual can be accessed by opening the index.html file in the <code>docs</code> subfolder using a web browser.</li>
</ol>
</section>
<section id="using-rstudio" class="level4">
<h4 class="anchored" data-anchor-id="using-rstudio">Using RStudio</h4>
<ol type="1">
<li>Open the quarto project in RStudio a. Start RStudio b. Click “Open Project…” on the <code>File</code> menu</li>
<li>Under the <code>View</code> menu, click <code>Show Build</code> to show the <code>Build</code> window</li>
<li>Click the “Render Website” icon in the <code>Build</code> window</li>
<li><ol start="3" type="1">
<li>will create the manual website in a <code>docs</code>subfolder of the local repo or source distribution.</li>
</ol></li>
<li>The manual can be accessed by opening the index.html file in the <code>docs</code> subfolder using a web browser.</li>
</ol>
<p>To re-render the local manual website (after, e.g., updating your local repository), delete the contents of the <code>docs</code> folder and re-run one of the sets of steps above.</p>
</section>
</section>
<section id="code-documentation" class="level3">
<h3 class="anchored" data-anchor-id="code-documentation">Code documentation</h3>
<p>A website with fairly extensive documentation for the TPL and C++ code can be created locally on your computer using <a href="https://www.doxygen.nl/index.html">Doxygen</a>. In order to do this, you will need doxygen installed on your computer (see the website for the latest version and installation instructions).</p>
<section id="using-doxywizard" class="level4">
<h4 class="anchored" data-anchor-id="using-doxywizard">Using Doxywizard</h4>
<p><code>Doxywizard</code> is a convenient graphical user interface provided to configure and run <code>doxygen</code>. To use the wizard, 1. Start <code>Doxywizard</code> 2. From the <code>File</code> menu, Click “Open…” and select the configuration file “Doxygen” in the top folder of the repo/source distribution. 3. Edit the following entries: a. change the working directory in which doxygen will run to the path to your repo/source distribution. b. If you have <code>dot</code> installed to create diagrams. 1. click the “Expert” button. 2. In the “Topics” window, select “Dot”. 3. Scroll to the “DOT_PATH” entry and provide the path to the <code>dot</code> executable on your computer. 4. Edit the various other entries in the “Wizard” or “Expert” views to suit your needs (the defaults will suit most needs). 5. Click the “Run” button. 6. Click the “Run doxygen” button to create the html documentation in the “doxy” subfolder. 7. If successful, Use “File&gt;Save” to save your changes to the configuration (“Doxyfile” or other) file.</p>
<p>The <code>Doxywizard</code> can also be used to create the documentation in other formats such as pdf or docbook by setting the appropriate options in the configuration file (see the online Doxygen documentation).</p>
</section>
</section>
</section>
<section id="testing" class="level2">
<h2 class="anchored" data-anchor-id="testing">Testing</h2>
<section id="new-approach-post-jan-2025" class="level3">
<h3 class="anchored" data-anchor-id="new-approach-post-jan-2025">new approach (post-Jan 2025)</h3>
<p>First, the “GMACS_Models” repository on GitHub (https://github.com/GMACS-project/GMACS_Models) should be cloned or downloaded. This repo contains subfolders in the “all_models” folder with files from the most recent assessment, as well as other models. The file “models-for_testing.csv” lists the subfolders to be used for testing (unless modified by the user, these will typically be the most recently-accepted assessment model).</p>
<p>The <code>testing/scripts</code> folder contains an R script, <code>runTests.R</code>, which can also be used to test (all or a subset of) the models identified in the “models-for_testing.csv” file. For each model, the script compares the new model results to the original results from the GMACS_Models repo by comparing the respective par and the Gmacsall.out files.</p>
<p>To run the tests:</p>
<ul>
<li>start an R session</li>
<li>Create a <code>testing/runs</code> or other suitable <code>runs</code> folder (if it doesn’t exist already)</li>
<li>change the working directory to the <code>runs</code> folder</li>
<li>source the “testing/scripts/runTests.R” file</li>
<li>run the function “runTests” for the models of interest
<ul>
<li>set <code>repoDir</code> to the path to the GMACS_Models repo</li>
<li>set <code>exeDir</code> to the path to the gmacs executable</li>
<li>set <code>stocks</code> to the stocks of interest (as listed in “models-for_testing.csv”, or NULL for all stocks)</li>
<li>set <code>testDir</code>, the top-level disctory for running the tests, to “.” (because you changed the working directory to the “runs” folder)</li>
<li>set <code>scriptsDir</code>, the path to the scripts folder (from the <code>runs</code> folder, if a relative path)</li>
<li>set <code>usePin</code> as “par” or “pin” to use “gmacs.par” or “gmacs.pin” from the original model run as a pin file (“none” does not use a pin file)</li>
<li>set <code>compareWith</code> as “par” or “pin” to compare the new “gmacs.par” to the “gmacs.par” or “gmacs.pin” from the original model run (“none” does no comparison)</li>
</ul></li>
</ul>
<p>Example codes are given at the end of the “runTests.R” file.</p>
<p>The results of the comparisons are returned as a R list, with element names corresponding to the stocks for the models tested. The returned list is also written to the testing folder as “testing_results.RData” (which will be overwritten in subsequent tests run in the same folder) and “testing_results_xxx.RData”, where “xxx” indicates the date and time at which the tests finished. Each element in the returned list is also a list, with elements <code>pars</code>, <code>allout</code>, <code>tblOld</code>, and <code>tblNew</code>. <code>pars</code> gives results from comparing the new par file with the original par (or pin) file, if the latter was available. Based on Andre Punt’s “TestUpdate.R” code, <code>allout</code> gives results from comparing the max gradient and OFL from the <code>Gmacsall.out</code> files, as well as several <code>ggplot2</code> plots comparing results for various estimated time series. The <code>tblOld</code> and <code>tblNew</code> are dataframes based on the “Gmacsall.out” “Summary” tables from the original and new model runs, respectively.</p>
<p>After copying the “testing/scripts/runTests_Report.qmd” file into the testing directory, it can be rendered as a pdf or html file to provide a simple report of the comparisons.</p>
</section>
<section id="old-approach-pre-jan-2025" class="level3">
<h3 class="anchored" data-anchor-id="old-approach-pre-jan-2025">old approach (pre-Jan 2025)</h3>
<p>The <code>testing/scripts</code> folder contains an R script, <code>runTests.old.R</code>, which can also be used to test the models in a folder (the default is “../input_files” from the testing folder). To run the tests from “testing/runs” with input files in “testing/input_files”:</p>
<ul>
<li>start an R session</li>
<li>Create a <code>testing/runs</code> folder (if it doesn’t exist already)</li>
<li>change the working directory to the <code>testing/runs</code> folder</li>
<li>source the “testing/scripts/runTests.old.R” file</li>
<li>run the function “runTests” for the models of interest
<ul>
<li>set the <code>tests</code> input vector to the names of the subfolders containing the models you want to test</li>
<li>set the top-level directory for running the tests (the default is “.”, i.e.&nbsp;the <code>testing/runs</code> folder)</li>
<li>set the <code>compareWithPin</code>, <code>verbose</code>, and <code>cleanup</code> flags as desired (<code>verbose</code> functionality is not yet implemented).</li>
</ul></li>
</ul>
<p>The function will run the models specified (copying the input files from relevant <code>testing/inut_files</code> subfolders). The output is a list with an element for each model tested. Each element indicates whether the test passed or, if not, where “substantial” differences (abs(new-old)&gt;<span class="math inline">\(10^{-5}\)</span>) occurred between the new par file and an old par file (“gmacs.par_old”) or the pin file (“gmacs.pin”) used to initialize the model.</p>
</section>
</section>
<section id="which-tools-are-available-for-working-with-gmacs" class="level2">
<h2 class="anchored" data-anchor-id="which-tools-are-available-for-working-with-gmacs">Which tools are available for working with GMACS?</h2>
<p>Currently GMACS is linked to <a href="gmacs-project.github.io/gmr/"><code>gmr</code></a>, an R package to work with GMACS in R, create plots of GMACS output, compare different models and prepare SAFE documents.</p>
</section>
<section id="the-gmacs-development-team" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="the-gmacs-development-team">The Gmacs development team</h2>
<p><a href="#tbl-contribs" class="quarto-xref">Table&nbsp;1</a> summarizes the people who have worked on the GMACS project since its inception.</p>
<div class="cell" data-layout-align="center">
<div id="tbl-contribs" class="cell quarto-float anchored" data-layout-align="center">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-contribs-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1: GMACS development team - Contributors.
</figcaption>
<div aria-describedby="tbl-contribs-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Contributors</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Organization</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left; font-weight: bold;">Jim Ianelli</td>
<td style="text-align: left;">Alaska Fisheries Science Center - NOAA</td>
</tr>
<tr class="even">
<td style="text-align: left; font-weight: bold;">D'Arcy Webber</td>
<td style="text-align: left;">Quantfish</td>
</tr>
<tr class="odd">
<td style="text-align: left; font-weight: bold;">Cody Szuwalski</td>
<td style="text-align: left;">Alaska Fisheries Science Center - NOAA</td>
</tr>
<tr class="even">
<td style="text-align: left; font-weight: bold;">Jack Turnock</td>
<td style="text-align: left;">Alaska Fisheries Science Center - NOAA</td>
</tr>
<tr class="odd">
<td style="text-align: left; font-weight: bold;">Jie Zheng</td>
<td style="text-align: left;">Alaska Department of Fish and Game</td>
</tr>
<tr class="even">
<td style="text-align: left; font-weight: bold;">Hamachan Hamazaki</td>
<td style="text-align: left;">Alaska Department of Fish and Game</td>
</tr>
<tr class="odd">
<td style="text-align: left; font-weight: bold;">Athol Whitten</td>
<td style="text-align: left;">School of Aquatic and Fishery Sciences - University of Washington</td>
</tr>
<tr class="even">
<td style="text-align: left; font-weight: bold;">Andre Punt</td>
<td style="text-align: left;">School of Aquatic and Fishery Sciences - University of Washington</td>
</tr>
<tr class="odd">
<td style="text-align: left; font-weight: bold;">David Fournier</td>
<td style="text-align: left;">Otter Research Ltd.</td>
</tr>
<tr class="even">
<td style="text-align: left; font-weight: bold;">John Levitt</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left; font-weight: bold;">Steve Martell</td>
<td style="text-align: left;">SeaState Inc.</td>
</tr>
<tr class="even">
<td style="text-align: left; font-weight: bold;">Matthieu Veron</td>
<td style="text-align: left;">School of Aquatic and Fishery Sciences - University of Washington</td>
</tr>
<tr class="odd">
<td style="text-align: left; font-weight: bold;">William Stockhausen</td>
<td style="text-align: left;">Alaska Fisheries Science Center - NOAA</td>
</tr>
</tbody>
</table>


</div>
</div>
</figure>
</div>
</div>
</section>
<section id="noaa-disclaimer" class="level2">
<h2 class="anchored" data-anchor-id="noaa-disclaimer">NOAA Disclaimer</h2>
<p>This repository is a scientific product and is not official communication of the National Oceanic and Atmospheric Administration, or the United States Department of Commerce. All NOAA GitHub project code is provided on an ‘as is’ basis and the user assumes responsibility for its use. Any claims against the Department of Commerce or Department of Commerce bureaus stemming from the use of this GitHub project will be governed by all applicable Federal law. Any reference to specific commercial products, processes, or services by service mark, trademark, manufacturer, or otherwise, does not constitute or imply their endorsement, recommendation or favoring by the Department of Commerce. The Department of Commerce seal and logo, or the seal and logo of a DOC bureau, shall not be used in any manner to imply endorsement of any commercial product or activity by DOC or the United States Government.</p>
<p>Software code created by U.S. Government employees is not subject to copyright in the United States (17 U.S.C. §105). The United States/Department of Commerce reserve all rights to seek and obtain copyright protection in countries other than the United States for Software authored in its entirety by the Department of Commerce. To this end, the Department of Commerce hereby grants to Recipient a royalty-free, nonexclusive license to use, copy, and create derivative works of the Software outside of the United States.</p>
<hr>
<p><img src="https://raw.githubusercontent.com/nmfs-general-modeling-tools/nmfspalette/main/man/figures/noaa-fisheries-rgb-2line-horizontal-small.png" height="75" alt="NOAA Fisheries"></p>
<p><a href="https://www.commerce.gov/">U.S. Department of Commerce</a> | <a href="https://www.noaa.gov">National Oceanographic and Atmospheric Administration</a> | <a href="https://www.fisheries.noaa.gov/">NOAA Fisheries</a></p>



</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-fournier_ad_2012" class="csl-entry" role="listitem">
Fournier, David A., Hans J. Skaug, Johnoel Ancheta, James Ianelli, Arni Magnusson, Mark N. Maunder, Anders Nielsen, and John Sibert. 2012. <span>“<span>AD</span> <span>Model</span> <span>Builder</span>: Using Automatic Differentiation for Statistical Inference of Highly Parameterized Complex Nonlinear Models.”</span> <em>Optimization Methods and Software</em> 27 (2): 233–49. <a href="https://doi.org/10.1080/10556788.2011.597854">https://doi.org/10.1080/10556788.2011.597854</a>.
</div>
<div id="ref-maunder_review_2013" class="csl-entry" role="listitem">
Maunder, Mark N., and André E. Punt. 2013. <span>“A Review of Integrated Analysis in Fisheries Stock Assessment.”</span> <em>Fisheries Research</em> 142: 61–74. <a href="https://doi.org/10.1016/j.fishres.2012.07.025">https://doi.org/10.1016/j.fishres.2012.07.025</a>.
</div>
<div id="ref-punt_review_2013" class="csl-entry" role="listitem">
Punt, A. E., T. Huang, and M. N. Maunder. 2013. <span>“Review of Integrated Size-Structured Models for Stock Assessment of Hard-to-Age Crustacean and Mollusc Species.”</span> <em>ICES Journal of Marine Science</em> 70 (1): 16–33. <a href="https://doi.org/10.1093/icesjms/fss185">https://doi.org/10.1093/icesjms/fss185</a>.
</div>
</div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
  </div>
  <div class="nav-page nav-page-next">
      <a href="./q02-File-organization.html" class="pagination-link" aria-label="File organization">
        <span class="nav-page-text">File organization</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
<p>v.2.01.M.09</p>
</div>
  </div>
</footer>




</body></html>